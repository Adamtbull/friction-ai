<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Friction AI</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
/* ================= BASE ================= */
*{box-sizing:border-box}
html,body{margin:0;padding:0;height:100%}
body{
  font-family:Inter,-apple-system,BlinkMacSystemFont,sans-serif;
  background:linear-gradient(180deg,#d4e8e6,#e8ecef);
  color:#1f2937;
  overscroll-behavior:none;
}

/* Lock page when in chat */
body.chat-mode{
  position:fixed;
  width:100%;
  overflow:hidden;
}

/* ================= VARIABLES ================= */
:root{
  --teal:#5a9a94;
  --teal-dark:#4a8a84;
  --white:#fff;
  --border:#d1d5db;
  --grey:#6b7280;
  --safe-top:env(safe-area-inset-top);
  --safe-bottom:env(safe-area-inset-bottom);
  --vv-bottom:0px;
}

/* ================= HOMEPAGE ================= */
.homepage{
  max-width:600px;
  margin:0 auto;
  padding:60px 24px;
  text-align:center;
}
.homepage.hidden{display:none}

.brand{letter-spacing:3px;color:var(--teal);font-size:0.8rem;margin-bottom:24px}
.headline{font-size:2rem;margin-bottom:12px}
.sub{color:var(--grey);margin-bottom:40px}

.btn{
  display:block;
  width:100%;
  max-width:280px;
  margin:12px auto;
  padding:14px;
  border-radius:8px;
  border:1px solid var(--border);
  background:var(--white);
  cursor:pointer;
}
.btn.primary{
  background:var(--teal);
  color:white;
  border:none;
}

/* ================= CHAT APP ================= */
.chat-app{
  display:none;
  position:fixed;
  inset:0;
  background:linear-gradient(180deg,#d4e8e6,#e8ecef);
}
.chat-app.active{display:block}

/* Header */
.chat-header{
  position:fixed;
  top:0;left:0;right:0;
  padding:16px 20px;
  padding-top:calc(16px + var(--safe-top));
  background:rgba(255,255,255,0.8);
  backdrop-filter:blur(10px);
  border-bottom:1px solid var(--border);
  z-index:10;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.chat-logo{color:var(--teal);font-size:0.8rem}

/* Messages */
.chat-messages{
  position:fixed;
  top:72px;
  bottom:calc(90px + var(--vv-bottom));
  left:0;right:0;
  padding:20px;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  display:flex;
  flex-direction:column;
  gap:16px;
}
.message{
  max-width:80%;
  padding:12px 16px;
  border-radius:16px;
  font-size:0.95rem;
}
.user{align-self:flex-end;background:var(--teal);color:white}
.ai{align-self:flex-start;background:white;border:1px solid var(--border)}

/* Input */
.chat-input-area{
  position:fixed;
  left:0;right:0;
  bottom:calc(var(--safe-bottom) + var(--vv-bottom));
  padding:12px 16px calc(16px + var(--safe-bottom));
  background:rgba(255,255,255,0.9);
  backdrop-filter:blur(10px);
  border-top:1px solid var(--border);
}
.chat-input-wrap{
  display:flex;
  gap:10px;
  align-items:flex-end;
}
textarea{
  flex:1;
  min-height:44px;
  max-height:150px;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--border);
  font-size:16px;
  resize:none;
}
.send{
  width:44px;height:44px;
  border-radius:12px;
  border:none;
  background:var(--teal);
  color:white;
  cursor:pointer;
}

/* ================= FRICTION OVERLAY ================= */
.friction{
  position:fixed;
  inset:0;
  background:rgba(255,255,255,0.95);
  backdrop-filter:blur(10px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:100;
}
.friction.active{display:flex}
.friction-box{
  background:white;
  padding:24px;
  border-radius:16px;
  width:100%;
  max-width:400px;
  text-align:center;
  border:1px solid var(--border);
}
code{
  display:block;
  background:#eee;
  padding:10px;
  border-radius:8px;
  margin-bottom:8px;
  user-select:none;
}
</style>
</head>

<body>

<!-- HOMEPAGE -->
<div class="homepage" id="homepage">
  <div class="brand">FRICTION AI</div>
  <h1 class="headline">Slow down your AI — on purpose.</h1>
  <p class="sub">Thoughtful friction creates awareness.</p>
  <button class="btn" id="start">Continue</button>
</div>

<!-- CHAT -->
<div class="chat-app" id="chat">
  <div class="chat-header">
    <div class="chat-logo">FRICTION AI</div>
    <button id="exit">✕</button>
  </div>

  <div class="chat-messages" id="messages">
    <div class="message ai">Welcome. Take your time.</div>
  </div>

  <div class="chat-input-area" id="composer">
    <div class="chat-input-wrap">
      <textarea id="input" placeholder="Type slowly…"></textarea>
      <button class="send" id="send">➤</button>
    </div>
  </div>
</div>

<!-- FRICTION -->
<div class="friction" id="friction">
  <div class="friction-box">
    <h3>Pause</h3>
    <code id="code"></code>
    <input id="codeInput" autocomplete="off">
    <button class="btn primary" id="unlock">Send</button>
  </div>
</div>

<script>
/* ================= STATE ================= */
const homepage=document.getElementById('homepage');
const chat=document.getElementById('chat');
const messages=document.getElementById('messages');
const input=document.getElementById('input');
const composer=document.getElementById('composer');
const friction=document.getElementById('friction');
const codeEl=document.getElementById('code');
const codeInput=document.getElementById('codeInput');

let pending=null;

/* ================= CHAT MODE LOCK ================= */
let scrollY=0;
function enterChat(){
  scrollY=window.scrollY;
  document.body.classList.add('chat-mode');
  document.body.style.top=`-${scrollY}px`;
  homepage.classList.add('hidden');
  chat.classList.add('active');
  window.scrollTo(0,0);
  updateKeyboard();
}
function exitChat(){
  document.body.classList.remove('chat-mode');
  document.body.style.top='';
  window.scrollTo(0,scrollY);
  chat.classList.remove('active');
  homepage.classList.remove('hidden');
}

/* ================= KEYBOARD FIX ================= */
function updateKeyboard(){
  if(!window.visualViewport) return;
  const vv=window.visualViewport;
  const covered=Math.max(0,window.innerHeight-vv.height);
  document.documentElement.style.setProperty('--vv-bottom',covered+'px');
  window.scrollTo(0,0);
}
window.visualViewport?.addEventListener('resize',updateKeyboard);
window.visualViewport?.addEventListener('scroll',updateKeyboard);

/* ================= INPUT AUTOGROW ================= */
input.addEventListener('input',()=>{
  input.style.height='auto';
  input.style.height=Math.min(input.scrollHeight,150)+'px';
});

/* ================= FRICTION ================= */
function genCode(){
  const chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789!@#$';
  let r='';
  for(let i=0;i<8;i++) r+=chars[Math.floor(Math.random()*chars.length)];
  return r;
}

document.getElementById('send').onclick=()=>{
  if(!input.value.trim()) return;
  pending=input.value;
  codeEl.textContent=genCode();
  codeInput.value='';
  friction.classList.add('active');
};

document.getElementById('unlock').onclick=()=>{
  if(codeInput.value!==codeEl.textContent) return;
  friction.classList.remove('active');
  const div=document.createElement('div');
  div.className='message user';
  div.textContent=pending;
  messages.appendChild(div);
  input.value='';
  input.style.height='auto';
};

/* ================= NAV ================= */
document.getElementById('start').onclick=enterChat;
document.getElementById('exit').onclick=exitChat;
</script>

</body>
</html>